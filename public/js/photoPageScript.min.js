(function(){"use strict";function a(a){return new Promise((b,c)=>{let d=new XMLHttpRequest;d.open("GET",a),d.onload=()=>{b(d.responseText)},d.onerror=()=>{c(d.error)},d.send()})}function b(a,b){for(let c,d=0;d<a.length;d++)c=a[d].getAttribute("id"),c===b[d].id&&(a[d].textContent=b[d].quality)}function c(a,b){return new Promise((c,d)=>{let e=new XMLHttpRequest;e.open("POST",a),e.setRequestHeader("Content-type","application/json; charset=utf-8"),e.onload=()=>{c(e.responseText)},e.onerror=()=>{d(e.error)},b=JSON.stringify(b),e.send(b)})}function d(a){let b=[];for(let c=0;c<a.length;c++)if(a[c].hasAttribute("data-like")){let d=a[c].parentNode.querySelector(".photo__like-count"),e=d.getAttribute("id"),f=d.textContent;b.push({id:e,quality:f})}return b}let e={photoNav:document.querySelector(".main-navPhoto"),photoHeader:document.querySelector(".page-headerPhoto")},f=new class{constructor(a,b){this.menu=a,this.header=b}open(){if(document.querySelector(".page-header__menu-active")){let a=document.querySelector(".page-header__menu-active");a.addEventListener("click",()=>{this.header.classList.remove("page-header--menu-close"),this.menu.classList.remove("main-nav--close")})}else return}close(){if(document.querySelector(".main-nav__close-menu")){let a=document.querySelector(".main-nav__close-menu");a.addEventListener("click",()=>{this.menu.classList.add("main-nav--close"),this.header.classList.add("page-header--menu-close")})}else return}}(e.photoNav,e.photoHeader);f.open(),f.close();let g=document.querySelector(".gallery__list");let h=new class{constructor(a=g){this.gallery=a}addLike(){try{let a=this.gallery.querySelectorAll(".gallery__btn-like");a=Array.from(a),this.addLikeHandler(a)}catch(a){console.log(a)}}addLikeHandler(a){a.forEach(a=>{a.addEventListener("click",()=>{let b=a.parentNode.querySelector(".gallery__like-count");a.hasAttribute("data-like")?(b.textContent=+b.textContent-1,a.removeAttribute("data-like")):(a.setAttribute("data-like","like"),b.textContent=+b.textContent+1)})})}};h.addLike(),window.addEventListener("load",()=>{let c=document.querySelectorAll(".photo__like-count");a("/getLikes").then(a=>{a=JSON.parse(a),b(c,a)}).catch(a=>{console.log(a)})}),window.addEventListener("beforeunload",()=>{let a=document.querySelectorAll(".photo__btn-like");c("/setLikes",d(a)).catch(a=>console.log(a))})})();